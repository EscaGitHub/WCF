<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\!Work\!GIT\SWR-Conf\Source\SWR-ConfiguratorAPI\SWR-Configurator\View\Panels\SpecificationUC.xaml.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;

namespace Swr.Configurator.View.Panels
{
	public partial class SpecificationUC
	{
		public SpecificationUC()
		{
            InitializeComponent();
		}

	    // PreviewMouseDown event handler on the TabControl
	    private void TabControl_PreviewMouseDown(object sender, MouseButtonEventArgs e)
	    {
	        if (IsUnderTabHeader(e.OriginalSource as DependencyObject))
	            CommitTables(TabControl);
	    }

	    private bool IsUnderTabHeader(DependencyObject control)
	    {
	        if (control is TabItem)
	            return true;
	        DependencyObject parent = VisualTreeHelper.GetParent(control);
	        if (parent == null)
	            return false;
	        return IsUnderTabHeader(parent);
	    }

	    private void CommitTables(DependencyObject control)
	    {
	        if (control is DataGrid)
	        {
	            DataGrid grid = control as DataGrid;
	            grid.CommitEdit(DataGridEditingUnit.Row, true);
	            return;
	        }
	        int childrenCount = VisualTreeHelper.GetChildrenCount(control);
	        for (int childIndex = 0; childIndex &lt; childrenCount; childIndex++)
	            CommitTables(VisualTreeHelper.GetChild(control, childIndex));
	    }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[10,3,10,27,0],[11,3,11,4,0],[12,13,12,35,0],[13,3,13,4,0],[17,6,17,7,0],[18,10,18,69,0],[19,14,19,39,0],[20,6,20,7,0],[23,6,23,7,0],[24,10,24,33,0],[25,14,25,26,0],[26,10,26,72,0],[27,10,27,29,0],[28,14,28,27,0],[29,10,29,42,0],[30,6,30,7,0],[33,6,33,7,0],[34,10,34,34,0],[35,10,35,11,0],[36,14,36,50,0],[37,14,37,61,0],[38,14,38,21,0],[40,10,40,73,0],[41,15,41,33,0],[41,35,41,61,0],[41,63,41,75,0],[42,14,42,75,0],[43,6,43,7,0]]);
    </script>
  </body>
</html>